<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manager Tasks</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        header {
          font-family: 'Poppins', sans-serif;
          background: linear-gradient(135deg, #ffffff, #ffffff);
          padding: 10px 0;
          text-align: left;
      }
      
      .nav-links {
          list-style-type: none;
          margin: 0;
          padding: 0;
          margin-left: 50px;
      
      }
      
      .nav-links li {
          display: inline-block;
          text-align: left;
          
      }
      
      .nav-links li a {
          color: #274cb3;
          text-decoration: none;
          padding: 10px 15px;
          display: inline-block;
          transition: background-color 0.3s;
          text-align: left;
          font-weight: bold;
      }
      
      .nav-links li a:hover {
          background-color: #e7e7e7;
              text-align: left;
      }
      
          </style>
      </head>
<body>
    <header>
        <div >
            <nav>
                <ul class="nav-links">
                    <li><a href="#">Home</a></li>
                    <li><a href="tasks.html">Manager Tasks</a></li>
                    <li><a href="profil.html">Manager Users</a></li>
                    <li><a href="#" onclick="logout()"> Logout</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <br>
    <div class="container">
        <div class="cardt">
          
            <h2>User Management ðŸ‘‹</h2>

            <h3>ðŸ“‹ User List</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Id</th>
                            <th>Username</th>
                            <th>Password</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="user-list">
                    </tbody>
                </table>
                <script>
                    // Function to load the user list
                    function loadUsers() {
                        fetch('/users/list')
                            .then(response => response.json())
                            .then(users => {
                                const userList = document.getElementById('user-list');
                                userList.innerHTML = ''; // Clear the table first
            
                                users.forEach(user => {
                                    const row = document.createElement('tr');
                                    row.innerHTML = `
                                        <td>${user.id}</td>
                                        <td>${user.username}</td>
                                        <td>${user.password}</td>
                                        <td>
                                            <button class="delete-btn" onclick="deleteUser(${user.id})">Delete</button>
                                        </td>
                                    `;
                                    userList.appendChild(row);
                                });
                            })
                            .catch(error => console.error('Error loading users:', error));
                    }
            
                    // Function to delete a user
                    function deleteUser(userId) {
                        const confirmation = confirm('Are you sure you want to delete this user?');
                        if (!confirmation) return;
            
                        fetch(`/users/delete/${userId}`, { method: 'DELETE' })
                            .then(response => response.json())
                            .then(data => {
                                if (data.message === 'User successfully deleted') {
                                    alert('User deleted');
                                    loadUsers(); // Reload the user list after deletion
                                } else {
                                    alert(data.message || 'An error occurred while deleting.');
                                }
                            })
                            .catch(error => console.error('Error deleting user:', error));
                    }
            
                    // Load users when the page starts
                    window.onload = loadUsers;
                </script>
            </div>
        </div>
    </div>
    
<br>
    <script src="script.js"></script>
</body>
</html>
